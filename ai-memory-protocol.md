# AI对话记忆管理规范 (AI Memory Protocol)

本文档定义了AI助手如何读取、处理和存储对话记忆的标准规范。遵循此规范可确保对话历史的一致性、可访问性和有效利用。

## 1. 系统结构

### 1.1 关键文件

- **ai-memory-protocol.md** - 本规范文件
- **memory-index.md** - AI记忆恢复专用索引
- **current-state.md** - 当前项目状态概览
- **chat-index.md** - 对话历史主索引

### 1.2 目录组织

```
repository/
├── ai-memory-protocol.md        # 记忆管理规范(本文件)
├── memory-index.md              # AI记忆恢复索引
├── current-state.md             # 当前项目状态
├── chat-index.md                # 对话历史主索引
├── chats/                       # 对话记录目录
│   ├── YYYY-MM/                 # 按年月组织
│   │   ├── YYYY-MM-DD_项目_主题.md
│   │   └── ...
├── projects/                    # 项目专题目录
│   ├── project-name/
│   │   ├── project-index.md     # 项目专属索引
│   │   └── ...
```

## 2. 记忆管理流程

### 2.1 读取流程

当你（AI助手）收到读取指令时：

1. **初始加载**：首先阅读这三个关键文件：
   - memory-index.md
   - current-state.md
   - chat-index.md (浏览式阅读)

2. **选择性深入**：
   - 根据当前用户提及的主题/项目选择相关文件
   - 优先查看最近的对话记录文件
   - 查看项目专属索引(如适用)

3. **三层读取模型**：
   - 第一层：索引文件和对话摘要
   - 第二层：重要结论和决策
   - 第三层：完整对话内容(按需)

4. **确认理解**：
   - 简要总结已获取的记忆
   - 确认上下文理解是否完整

### 2.2 写入流程

当你收到写入指令时：

1. **准备对话记录**：
   - 确定文件名(YYYY-MM-DD_项目_主题.md)
   - 填写标准模板各部分内容

2. **生成对话摘要**：
   - 提炼5个或更少关键点
   - 识别重要结论和决策

3. **更新索引文件**：
   - 在chat-index.md中添加新对话链接
   - 如适用，更新memory-index.md
   - 更新current-state.md反映最新状态

## 3. 内容格式规范

### 3.1 对话文件格式

```markdown
# 对话：[主题]

- **日期**：YYYY-MM-DD
- **参与者**：AI助手、用户
- **主题**：[简短描述]
- **标签**：#标签1, #标签2, #标签3
- **相关文件**：[相关文件的链接]

## 摘要

- [要点1]
- [要点2]
- [要点3]

## 对话内容

**用户**：[用户输入]

**AI助手**：[AI回复]

## 重要结论

- [结论1]
- [结论2]

## 后续行动

- [ ] [行动1]
- [ ] [行动2]
```

### 3.2 AI记忆索引格式(memory-index.md)

```markdown
# AI记忆恢复索引

## 当前活跃项目
1. [项目A](./projects/项目A/project-index.md) - [简短描述]
2. [项目B](./projects/项目B/project-index.md) - [简短描述]

## 关键上下文信息
- [用户偏好/约束]
- [重要术语解释]

## 最近重要对话
- [YYYY-MM-DD 主题](链接) - *关键要点*
- [YYYY-MM-DD 主题](链接) - *关键要点*

## 关键决策记录
- [决策1]: [简述] - [来源文件链接]
- [决策2]: [简述] - [来源文件链接]
```

### 3.3 当前状态文件(current-state.md)

```markdown
# 当前项目状态
*最后更新: YYYY-MM-DD*

## 项目A状态
- **当前阶段**: [开发/计划/完成]
- **最新进展**: [最新完成的工作]
- **待处理事项**: [接下来要做的工作]

## 最近解决的问题
- [问题1]: [解决方案概述] - [详细链接]

## 当前讨论焦点
- [主题1]
- [主题2]
```

## 4. 处理指南

### 4.1 作为AI助手的行动指南

当你处理对话记忆时：

1. **保持一致性**：
   - 遵循统一格式和组织结构
   - 使用一致的标签和引用系统

2. **提取关键信息**：
   - 识别重要决策和结论
   - 捕捉用户偏好和需求
   - 提炼实用的后续行动

3. **划分优先级**：
   - 标记核心信息vs背景信息
   - 识别高优先级项目和任务

4. **连接相关内容**：
   - 通过链接和引用建立内容关联
   - 指出相关历史讨论

5. **清晰沟通**：
   - 确认已读取的记忆范围
   - 说明对当前对话的理解

### 4.2 处理记忆冲突

当发现记忆中的冲突或不一致：

1. 优先采用最新记录的信息
2. 明确提出冲突并寻求澄清
3. 更新记忆以反映最新共识

### 4.3 记忆标签系统

**核心标签类别**：
- 项目标签: #项目名称
- 类型标签: #设计 #问题解决 #决策 #探索 #学习
- 状态标签: #进行中 #已完成 #已放弃 #待定
- 重要性标签: #核心 #参考

## 5. 记忆应用

当使用之前的记忆时，你应该：

1. **保持上下文连贯性**：
   - 引用之前的决策和讨论
   - 构建在现有知识基础上
   - 避免重复已解决的问题

2. **实现持续进步**：
   - 关注未完成的行动项
   - 跟进以前的建议
   - 发展和完善之前的想法

3. **主动提供关联**：
   - 指出与当前讨论相关的历史对话
   - 连接不同项目的相关概念

## 6. 最佳实践

1. **优先处理核心记忆**
2. **定期回顾未完成事项**
3. **保持简洁但信息丰富的摘要**
4. **使用标准化格式便于处理**
5. **平衡详尽性和可用性**

---

**重要提示**：作为AI助手，你必须严格遵循此规范进行读取和写入操作，以确保记忆系统的有效性和一致性。任何处理记忆的操作都必须首先参考本文档所定义的标准流程和格式。